{"remainingRequest":"/Users/admin/projects/cybercrowdcoin-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/admin/projects/cybercrowdcoin-web/src/views/PersonalCenter/EmployerDemand/DemandNew.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/admin/projects/cybercrowdcoin-web/src/views/PersonalCenter/EmployerDemand/DemandNew.vue","mtime":1699024264000},{"path":"/Users/admin/projects/cybercrowdcoin-web/node_modules/cache-loader/dist/cjs.js","mtime":1699331769630},{"path":"/Users/admin/projects/cybercrowdcoin-web/node_modules/vue-loader/lib/index.js","mtime":1699331770008}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IENhdGVnb3J5RGF0YSB9IGZyb20gIkAvZGF0YS9jYXRlZ29yeS5qcyI7CmltcG9ydCB7IGFwcHJvdmUsIGNyZWF0ZURlbWFuZENvbnRyYWN0IH0gZnJvbSAiQC9zZXJ2aWNlL2RlbWFuZF9zZXJ2aWNlIjsKCmltcG9ydCB7IHJlcVVybCB9IGZyb20gIkAvYXBpL2FwaVVybCI7CmltcG9ydCB7IHJlcXVlc3RHZXQsIHJlcXVlc3QgfSBmcm9tICJAL2FwaS9yZXF1ZXN0IjsKaW1wb3J0IHsgc2hvd0xvYWRpbmcsIGhpZGVMb2FkaW5nIH0gZnJvbSAiQC91dGlsL2xvYWRpbmciOwoKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBydWxlRm9ybTogewogICAgICAgIHRpdGxlOiAiIiwKICAgICAgICBjYXRlZ29yeTogIiIsCiAgICAgICAgb3B0aW9uc0NhdGVnb3J5OiBbXSwKICAgICAgICBwaG9uZTogIiIsCiAgICAgICAgdG9rZW5EZXBvc2l0TnVtOiAxMCwKICAgICAgICBkZW1hbmRCdWRnZXROdW06IDAsCiAgICAgICAgZGVzYzogIiIsCiAgICAgIH0sCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgdGl0bGU6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICJQbGVhc2UgZW50ZXIgVGl0bGUiLCB0cmlnZ2VyOiAiYmx1ciIgfSwKICAgICAgICBdLAogICAgICAgIGNhdGVnb3J5OiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAiU2VsZWN0IGEgY2F0ZWdvcnkiLCB0cmlnZ2VyOiAiYmx1ciIgfSwKICAgICAgICBdLAogICAgICAgIHBob25lOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAiUGxlYXNlIGVudGVyIFBob25lIiwgdHJpZ2dlcjogImJsdXIiIH0sCiAgICAgICAgXSwKICAgICAgICAvLyBkZW1hbmRCdWRnZXQ6IFsKICAgICAgICAvLyAgIHsKICAgICAgICAvLyAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgLy8gICAgIG1lc3NhZ2U6ICJQbGVhc2UgZW50ZXIgdGhlIGRlbWFuZCBidWRnZXQiLAogICAgICAgIC8vICAgICB0cmlnZ2VyOiAiYmx1ciIsCiAgICAgICAgLy8gICB9LAogICAgICAgIC8vIF0sCiAgICAgICAgZGVzYzogWwogICAgICAgICAgewogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgICAgbWVzc2FnZTogIlBsZWFzZSBlbnRlciBEZXNjcmlwdGlvbiIsCiAgICAgICAgICAgIHRyaWdnZXI6ICJibHVyIiwKICAgICAgICAgIH0sCiAgICAgICAgXSwKICAgICAgfSwKICAgIH07CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5ydWxlRm9ybS5vcHRpb25zQ2F0ZWdvcnkgPSBDYXRlZ29yeURhdGE7CiAgfSwKCiAgbWV0aG9kczogewogICAgc3VibWl0Rm9ybShmb3JtTmFtZSkgewogICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS52YWxpZGF0ZSgodmFsaWQpID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIHNob3dMb2FkaW5nKCk7CiAgICAgICAgICBjb25zdCBvcHQgPSB7CiAgICAgICAgICAgIHVybDogcmVxVXJsLmFkZGlwZnNEZW1hbmQsCiAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICB0aXRsZTogdGhpcy5ydWxlRm9ybS50aXRsZSwKICAgICAgICAgICAgICBjYXRlZ29yeToKICAgICAgICAgICAgICAgIHRoaXMucnVsZUZvcm0uY2F0ZWdvcnlbdGhpcy5ydWxlRm9ybS5jYXRlZ29yeS5sZW5ndGggLSAxXSwKICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5ydWxlRm9ybS5kZXNjLAogICAgICAgICAgICAgIHBob25lOiB0aGlzLnJ1bGVGb3JtLnBob25lLAogICAgICAgICAgICAgIGJ1ZGdldDogdGhpcy5ydWxlRm9ybS5kZW1hbmRCdWRnZXROdW0sCiAgICAgICAgICAgICAgdG9rZW5BbW91bnQ6IHRoaXMucnVsZUZvcm0udG9rZW5EZXBvc2l0TnVtLAogICAgICAgICAgICB9LAogICAgICAgICAgICByZXNGdW5jOiBhc3luYyAocmVzKSA9PiB7CiAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmVycm5vID09IDApIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIGNvbnN0IGlwZnMgPSByZXMuZGF0YS5kYXRhLnVybCB8fCAiIjsKICAgICAgICAgICAgICAgICAgaWYgKGlwZnMpIHsKICAgICAgICAgICAgICAgICAgICBhd2FpdCBhcHByb3ZlKHRoaXMucnVsZUZvcm0udG9rZW5EZXBvc2l0TnVtKTsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YU9iaiA9IHsgLi4udGhpcy5ydWxlRm9ybSwgaXBmc1VybDogaXBmcyB9OwogICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc0hhc2ggPSBhd2FpdCBjcmVhdGVEZW1hbmRDb250cmFjdChkYXRhT2JqKTsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0cmFuc0hhc2gpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge30KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmVycm5vICE9IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuJG5vdGlmeS5lcnJvcih7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiAiZXJyb3IiLAogICAgICAgICAgICAgICAgICBtZXNzYWdlOiByZXMuZGF0YS5tZXNzYWdlLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBoaWRlTG9hZGluZygpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBoaWRlTG9hZGluZygpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBlcnJGdW5jOiAoZXJyKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy4kbm90aWZ5LmVycm9yKHsKICAgICAgICAgICAgICAgIHRpdGxlOiAiZXJyb3IiLAogICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyLAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVyciwgImVycjEiKTsKICAgICAgICAgICAgICBoaWRlTG9hZGluZygpOwogICAgICAgICAgICB9LAogICAgICAgICAgfTsKICAgICAgICAgIHJlcXVlc3Qob3B0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coImVycm9yIHN1Ym1pdCEhIik7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICByZXNldEZvcm0oZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0ucmVzZXRGaWVsZHMoKTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["DemandNew.vue"],"names":[],"mappings":";AAsFA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DemandNew.vue","sourceRoot":"src/views/PersonalCenter/EmployerDemand","sourcesContent":["<template>\n  <div class=\"demand_new_list\">\n    <el-form\n      :model=\"ruleForm\"\n      :rules=\"rules\"\n      ref=\"ruleForm\"\n      class=\"demo-ruleForm\"\n    >\n      <el-form-item prop=\"title\">\n        <span slot=\"label\">\n          <i\n            class=\"iconfont icon-a-titleoptimization\"\n            style=\"font-size: 19px\"\n          ></i>\n          Title</span\n        >\n        <el-input\n          v-model=\"ruleForm.title\"\n          placeholder=\"Please enter Title\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item prop=\"category\">\n        <span slot=\"label\"> <i class=\"iconfont icon-leibie\"></i> Category</span>\n        <el-cascader\n          v-model=\"ruleForm.category\"\n          :options=\"ruleForm.optionsCategory\"\n          placeholder=\"Select a category\"\n        ></el-cascader>\n      </el-form-item>\n      <el-form-item prop=\"phone\">\n        <span slot=\"label\">\n          <i class=\"iconfont icon-31dianhua\" style=\"font-size: 19px\"></i>\n          Phone</span\n        >\n        <el-input\n          v-model=\"ruleForm.phone\"\n          placeholder=\"Please enter Phone\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item>\n        <span slot=\"label\">\n          <i class=\"iconfont icon-cunkuan\" style=\"font-size: 19px\"></i> Token\n          Deposit</span\n        >\n        <el-input-number\n          v-model=\"ruleForm.tokenDepositNum\"\n          :min=\"0\"\n        ></el-input-number>\n      </el-form-item>\n      <el-form-item prop=\"demandBudget\">\n        <span slot=\"label\">\n          <i class=\"iconfont icon-jiagebaohu\" style=\"font-size: 19px\"></i>\n          Demand Budget</span\n        >\n        <el-input-number\n          v-model=\"ruleForm.demandBudgetNum\"\n          :precision=\"2\"\n          :step=\"0.1\"\n          :min=\"0\"\n        ></el-input-number>\n      </el-form-item>\n      <el-form-item prop=\"desc\">\n        <span slot=\"label\">\n          <i class=\"iconfont icon-describe\"></i> Description</span\n        >\n        <el-input\n          type=\"textarea\"\n          v-model=\"ruleForm.desc\"\n          placeholder=\"Please enter Description\"\n        ></el-input>\n      </el-form-item>\n      <div class=\"ruleForm_footer\">\n        <el-form-item>\n          <el-button type=\"info\" @click=\"submitForm('ruleForm')\"\n            >Submit</el-button\n          >\n          <el-button @click=\"resetForm('ruleForm')\" type=\"success\"\n            >Empty</el-button\n          >\n        </el-form-item>\n      </div>\n    </el-form>\n  </div>\n</template>\n\n<script>\nimport { CategoryData } from \"@/data/category.js\";\nimport { approve, createDemandContract } from \"@/service/demand_service\";\n\nimport { reqUrl } from \"@/api/apiUrl\";\nimport { requestGet, request } from \"@/api/request\";\nimport { showLoading, hideLoading } from \"@/util/loading\";\n\nexport default {\n  data() {\n    return {\n      ruleForm: {\n        title: \"\",\n        category: \"\",\n        optionsCategory: [],\n        phone: \"\",\n        tokenDepositNum: 10,\n        demandBudgetNum: 0,\n        desc: \"\",\n      },\n      rules: {\n        title: [\n          { required: true, message: \"Please enter Title\", trigger: \"blur\" },\n        ],\n        category: [\n          { required: true, message: \"Select a category\", trigger: \"blur\" },\n        ],\n        phone: [\n          { required: true, message: \"Please enter Phone\", trigger: \"blur\" },\n        ],\n        // demandBudget: [\n        //   {\n        //     required: true,\n        //     message: \"Please enter the demand budget\",\n        //     trigger: \"blur\",\n        //   },\n        // ],\n        desc: [\n          {\n            required: true,\n            message: \"Please enter Description\",\n            trigger: \"blur\",\n          },\n        ],\n      },\n    };\n  },\n  mounted() {\n    this.ruleForm.optionsCategory = CategoryData;\n  },\n\n  methods: {\n    submitForm(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          showLoading();\n          const opt = {\n            url: reqUrl.addipfsDemand,\n            method: \"POST\",\n            params: {\n              title: this.ruleForm.title,\n              category:\n                this.ruleForm.category[this.ruleForm.category.length - 1],\n              description: this.ruleForm.desc,\n              phone: this.ruleForm.phone,\n              budget: this.ruleForm.demandBudgetNum,\n              tokenAmount: this.ruleForm.tokenDepositNum,\n            },\n            resFunc: async (res) => {\n              if (res.data.errno == 0) {\n                try {\n                  const ipfs = res.data.data.url || \"\";\n                  if (ipfs) {\n                    await approve(this.ruleForm.tokenDepositNum);\n\n                    const dataObj = { ...this.ruleForm, ipfsUrl: ipfs };\n                    var transHash = await createDemandContract(dataObj);\n                    console.log(transHash);\n                  }\n                } catch (error) {}\n              }\n              if (res.data.errno != 0) {\n                this.$notify.error({\n                  title: \"error\",\n                  message: res.data.message,\n                });\n                hideLoading();\n              }\n              hideLoading();\n            },\n            errFunc: (err) => {\n              this.$notify.error({\n                title: \"error\",\n                message: err,\n              });\n              console.log(err, \"err1\");\n              hideLoading();\n            },\n          };\n          request(opt);\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"../index.scss\";\n\n.demand_new_list {\n  width: 70%;\n  margin: 0 auto;\n}\n</style>\n\n<style>\n@import \"../../../Index.scss\";\n</style>\n"]}]}